<p>Recently I was asked how can you get a list of anonymous type member names given a query of anonymous types.&nbsp; The quick answer is that you can use a quick bit of reflection to get back the names.&nbsp; </p><pre class="code">    <span style="color: rgb(0,0,255)">Public</span> <span style="color: rgb(0,0,255)">Function</span> GetAnonymousTypeMemberNames(<span style="color: rgb(0,0,255)">Of</span> T)(<span style="color: rgb(0,0,255)">ByVal</span> anonymousType <span style="color: rgb(0,0,255)">As</span> T) <span style="color: rgb(0,0,255)">As</span> List(<span style="color: rgb(0,0,255)">Of</span> <span style="color: rgb(0,0,255)">String</span>)
        <span style="color: rgb(0,0,255)">Dim</span> type = <span style="color: rgb(0,0,255)">GetType</span>(T)
        <span style="color: rgb(0,0,255)">Dim</span> list = <span style="color: rgb(0,0,255)">New</span> List(<span style="color: rgb(0,0,255)">Of</span> <span style="color: rgb(0,0,255)">String</span>)
        <span style="color: rgb(0,0,255)">For</span> <span style="color: rgb(0,0,255)">Each</span> cur <span style="color: rgb(0,0,255)">In</span> type.GetProperties(Reflection.BindingFlags.Public <span style="color: rgb(0,0,255)">Or</span> Reflection.BindingFlags.Instance)
            list.Add(cur.Name)
        <span style="color: rgb(0,0,255)">Next
</span>        <span style="color: rgb(0,0,255)">Return</span> list
    <span style="color: rgb(0,0,255)">End</span> <span style="color: rgb(0,0,255)">Function</span></pre>
<p>The longer question is how can you get back a list of anonymous type member names given a query result?&nbsp; As long as you know the query will be populated you can just use the first member to get your result.</p><pre class="code">        <span style="color: rgb(0,0,255)">Dim</span> q = <span style="color: rgb(0,0,255)">From</span> it <span style="color: rgb(0,0,255)">In</span> <span style="color: rgb(163,21,21)">"astring"</span> <span style="color: rgb(0,0,255)">Select</span> a = it, b = it &amp; <span style="color: rgb(163,21,21)">"b"
</span>        GetAnonymousTypeMemberNames(q.First())</pre>
<p><a href="http://11011.net/software/vspaste"></a>However you can't guarantee that a query will always have data in it.&nbsp; Another route is to consider the contract of the From ... Select statement.&nbsp; This will produce a query which implements <a href="http://msdn2.microsoft.com/en-us/library/9eekhta0.aspx">IEnumerable(Of T).</a>&nbsp; For a query T will be the anonymous type that is generated[1].&nbsp; We can query the metadata of the returned type to get the System.Type for the anonymous type regardless of the type actually implementing <a href="http://msdn2.microsoft.com/en-us/library/9eekhta0.aspx">IEnumerable(Of T).</a>&nbsp; </p><pre class="code">        <span style="color: rgb(0,0,255)">Dim</span> q = <span style="color: rgb(0,0,255)">From</span> it <span style="color: rgb(0,0,255)">In</span> <span style="color: rgb(163,21,21)">"astring"</span> <span style="color: rgb(0,0,255)">Select</span> a = it, b = it &amp; <span style="color: rgb(163,21,21)">"b"
</span>        <span style="color: rgb(0,0,255)">Dim</span> enumerableInterface = <span style="color: rgb(0,0,255)">GetType</span>(IEnumerable(<span style="color: rgb(0,0,255)">Of</span> ))
        <span style="color: rgb(0,0,255)">Dim</span> enumerableType = q.GetType().GetInterface(enumerableInterface.FullName)
        <span style="color: rgb(0,0,255)">Dim</span> anonymousTypeType = enumerableType.GetGenericArguments(0)</pre>
<p>[1] This is assuming that you didn't write a query which returns a field directly and avoids creating the anonymous type.&nbsp; </p></div>
    