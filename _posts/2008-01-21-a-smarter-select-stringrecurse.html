<p>Previously I blogged about a <a href="http://blogs.msdn.com/jaredpar/archive/2007/10/08/select-stringrecurse.aspx">recursive select-string function.</a>&nbsp; Recently I've extended it a bit.&nbsp; I found the function to be very useful but when I encountered problems searching large directories that contained binary files.&nbsp; Namely searching them usually returned a result of sorts and printing out the contents of a binary file caused my console to beep in a rather annoying fashion.&nbsp; To fix this I added a new parameter that will perform a slightly smarter search by filtering out binary files.</p> <p>function Select-StringRecurse()<br>{<br>&nbsp;&nbsp;&nbsp; param ( [string]$text = $(throw "Need text to search for"),<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [string[]]$include = "*",<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [switch]$smart = $false)  <p>&nbsp;&nbsp;&nbsp; $smartRegex = "^\.(lib|exe|obj|bin|tlb|pdb)$"<br>&nbsp;&nbsp;&nbsp; gci -re -in $include | <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ? { -not $_.PSIsContainer } | <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ? { (-not ($smart)) -or (-not ($_.Extension -match $smartRegex)) } |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; % { write-debug "Considering: $($_.FullName)"; ss $text $_.FullName }<br>}&nbsp;&nbsp; </div>
    