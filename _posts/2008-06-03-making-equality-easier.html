<p>Recently I've done a bit of posting about the difficulties of <a href="http://blogs.msdn.com/jaredpar/archive/2008/05/12/equality-isn-t-easy.aspx">properly implementing equality</a> <a href="http://blogs.msdn.com/jaredpar/archive/2008/04/28/properly-implementing-equality-in-vb.aspx">in VB</a> (and DotNet in general).&nbsp; While most of the problems can be fixed with a standard snippet the one really hard to implement issue is GetHashCode().&nbsp; The rules for GetHashCode() are both simple and seemingly contradictory</p> <ol> <li>If two objects are equal (via Equals) their GetHashCode() should be equal</li> <li>GetHashCode() shouldn't ever change </li></ol> <p>These rules imply that GetHashCode() is related to Equality.&nbsp; At a fundamental level though GetHashCode has nothing to do with Equality.&nbsp; Instead it is linked to bucketing and ultimately any hashing sturcture such as Dictionary, Hashtable, etc ...&nbsp; </p> <p>Unfortunately it is impossible to separate these two from an API perspective because it is ingrained into the BCL.&nbsp; There is a way to separate this out at a functionality level and still satisfy all of the rules of the GetHashCode() and Equals()</p><pre class="code">    <span style="color: rgb(0,0,255)">Public</span> <span style="color: rgb(0,0,255)">Overrides</span> <span style="color: rgb(0,0,255)">Function</span> GetHashCode() <span style="color: rgb(0,0,255)">As</span> <span style="color: rgb(0,0,255)">Integer
</span>        <span style="color: rgb(0,0,255)">Return</span> 1
    <span style="color: rgb(0,0,255)">End</span> <span style="color: rgb(0,0,255)">Function</span></pre>
<p>This absolutely maintains both of the rules for GetHashCode().&nbsp; This allows you to completely separate Equality and GetHashCode() in your implementation while not breaking any BCL rules or assumptions. </p>
<p>Of course this does come with a trade off.&nbsp; As said before GetHashCode() is primarily used as a bucketing mechanism.&nbsp; It will cause the performance of bucketing collections such as Dictionary or Hashtable to drop from close to O(1) to O(N).&nbsp; But once again this is not a bug but a conscious trade off.&nbsp; </p></div>
    