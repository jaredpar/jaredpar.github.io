<P><A href="http://blogs.msdn.com/jaredpar/archive/2008/01/22/tuples-part-5-equality.aspx" mce_href="http://blogs.msdn.com/jaredpar/archive/2008/01/22/tuples-part-5-equality.aspx">Part 5</A> produced equality tests for Tuples.&nbsp; This section will add comparison support through the <A href="http://msdn2.microsoft.com/en-us/library/4d7sx9hd.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/4d7sx9hd.aspx">IComparable&lt;T&gt;</A> interface.&nbsp; Implementing comparable is very similar to adding equality support.&nbsp; Once again there is a generic class available to make all of the comparison decisions for us; <A href="http://msdn2.microsoft.com/en-us/library/cfttsh47.aspx" mce_href="http://msdn2.microsoft.com/en-us/library/cfttsh47.aspx">Comparer&lt;T&gt;</A>.&nbsp; </P>
<P>The implementation will compare objects in a left to right fashion.&nbsp; In this case the property corresponding to TA will be the left most, and TN the right most.&nbsp; If all properties are equal (Compare returns 0) then the two items will be determined to be equal and will return 0.</P>
<P>function script:Gen-CompareTo <BR>{ <BR>&nbsp;&nbsp;&nbsp; param ( [int] $count = $(throw "Need a count") ) <BR>&nbsp;&nbsp;&nbsp; $OFS = ',' <BR>&nbsp;&nbsp;&nbsp; $gen = "&lt;" + [string](0..($count-1) | %{ "T"+$upperList[$_] }) + "&gt;"&nbsp;&nbsp;&nbsp;&nbsp; <BR>&nbsp;&nbsp;&nbsp; "public int CompareTo(object other) {" <BR>&nbsp;&nbsp;&nbsp; "return CompareTo(other as Tuple$gen); }" <BR>&nbsp;&nbsp;&nbsp; "public int CompareTo(Tuple$gen other) {" <BR>&nbsp;&nbsp;&nbsp; "if ( Object.ReferenceEquals(other,null) ) { return 1; }" <BR>&nbsp;&nbsp;&nbsp; "int code;" <BR>&nbsp;&nbsp;&nbsp; 0..($count-1) | <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; %{ "code = Comparer&lt;T{0}&gt;.Default.Compare(m_{1},other.m_{1}); if (code != 0) {{ return code; }}" -f $upperList[$_],$lowerList[$_] } <BR>&nbsp;&nbsp;&nbsp; "return 0; }" <BR>}</P>
<P>Once again the same questions arise about implementing IComparable&lt;Tuple&gt; vs IComparable&lt;ITuple&gt; (or both).&nbsp; The arguments are fairly similar and as a result I decided to skip implementing the ITuple version for now.</P></div>
    