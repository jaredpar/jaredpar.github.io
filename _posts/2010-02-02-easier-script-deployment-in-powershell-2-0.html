<p>If you can’t tell from reading entries in my blog I’m a bit of a script junkie.&#160; I loathe typing out the same command sequence more than once.&#160; As such I go to great lengths to script as much as possible in life.&#160; I also enjoy sharing my scripts with other members of my team.</p>  <p>Unfortunately deployment of PowerShell scripts has long been a point of pain for me.&#160; In the early 1.0 days PowerShell wasn’t installed by default on any OS so the only people with PowerShell were other scripter's.&#160; Deploying to the masses simply wasn’t possible without installing PowerShell which is a significant adoption barrier.&#160; Even if PowerShell was installed, the default setup forbids the execution of any script file.&#160; Allowing scripts to run in 1.0 requires both Administrative privileges and a rather awkward command sequence: set-executionpolicy RemoteSigned.&#160; </p>  <p>These two combined to make it nearly impossible to distribute my scripts to the masses.&#160; Other devs, after explanations, understood the problems I encountered.&#160; But the masses simply did not.&#160; The wanted a quick, one or two click solution to their problem.&#160; Running a powershell script was simply too involved.&#160; </p>  <p>The best solution I found was to distribute both a .cmd and a .ps1 file.&#160; The .cmd file’s job was to set the special registry key to allow script execution and then run the script.&#160; This still hurt adoption because it required administrative privileges and an existing copy of powershell on the machine.&#160; </p>  <p>Thankfully the story is quite a bit better in 2.0&#160; The primary improvement is simply adoption.&#160; PowerShell is installed by default in Windows7 and certain flavors of W2K8.&#160; Windows7 is very popular amongst my coworkers and hence I can depend on at least a PowerShell deployment when I write my scripts.</p>  <p>The next improvement surrounds the execution of scripts.&#160; The default is still to have script execution disabled but you no longer have to be an administrator to do so.&#160; Additionally you can specify on the PowerShell command line what the execution policy can be.&#160; This mean you can have a script execute without the user having to manually enable script execution.&#160; </p>  <p>The command line is still a bit awkward.&#160; But it’s easily solved by deploying both a .cmd and .ps1 file.&#160; The .cmd file simply calls the .ps1 file with the awkward command line.&#160; Users are comfortable clicking on a .cmd file and it removes all knowledge of powershell from the equation.&#160; </p>  <p>For example: </p>  <p>Fix-Setup.cmd</p>  <pre>set SOURCE=%~dp0
set TARGET=%SOURCE%\Fix-Setup.ps1
powershell -ExecutionPolicy RemoteSigned %TARGET%</pre>

<p>These small changes greatly increased the adoption rate of scripts within my group.&#160;&#160; </p></div>
    