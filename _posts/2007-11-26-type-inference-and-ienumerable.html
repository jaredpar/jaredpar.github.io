<p>This is somewhat of a follow up on a previous <a href="http://blogs.msdn.com/jaredpar/archive/2007/10/04/ienumerable-and-ienumerable-of-t.aspx">post</a> I did on the difference between <a href="http://msdn2.microsoft.com/en-us/library/9eekhta0.aspx">IEnumerable(Of T)</a> and the <a href="http://msdn2.microsoft.com/en-us/library/9eekhta0.aspx">IEnumerable</a> interfaces.&nbsp; </p> <p>I've seen several people type in the following code and wonder if there was a fundamental bug in the type inference code.</p><pre class="code">    <span style="color: rgb(0,0,255)">Private</span> <span style="color: rgb(0,0,255)">Sub</span> Form1_Load(<span style="color: rgb(0,0,255)">ByVal</span> sender <span style="color: rgb(0,0,255)">As</span> System.Object, <span style="color: rgb(0,0,255)">ByVal</span> e <span style="color: rgb(0,0,255)">As</span> System.EventArgs) <span style="color: rgb(0,0,255)">Handles</span> <span style="color: rgb(0,0,255)">MyBase</span>.Load
        <span style="color: rgb(0,0,255)">For</span> <span style="color: rgb(0,0,255)">Each</span> cur <span style="color: rgb(0,0,255)">In</span> Controls
            cur.Text = <span style="color: rgb(163,21,21)">"A Value"
</span>        <span style="color: rgb(0,0,255)">Next
</span>    <span style="color: rgb(0,0,255)">End</span> <span style="color: rgb(0,0,255)">Sub</span></pre><a href="http://11011.net/software/vspaste"></a>
<p>This code will produce an error stating that "Text" is not a member of object.&nbsp; Users expected type inference to type the variable "cur" as Control.&nbsp; Unfortunately this is "By Design".&nbsp; </p>
<p>Much of the original .Net Framework was written before the CLR implemented support for generics.&nbsp; As a result all of the collection classes were loosely typed to Object by implementing <a href="http://msdn2.microsoft.com/en-us/library/9eekhta0.aspx">IEnumerable</a>.&nbsp; So in this case type inference will correctly type this as Object.</p>
<p>There are 2 ways to fix this problem. </p>
<ol>
<li>Explicitly type the For Each variable to be the actual type of objects in the collection</li>
<li>Use a Shim to change the type of the collection. (see <a title="http://blogs.msdn.com/jaredpar/archive/2007/10/04/ienumerable-and-ienumerable-of-t.aspx" href="http://blogs.msdn.com/jaredpar/archive/2007/10/04/ienumerable-and-ienumerable-of-t.aspx">http://blogs.msdn.com/jaredpar/archive/2007/10/04/ienumerable-and-ienumerable-of-t.aspx</a>)</li></ol></div>
    