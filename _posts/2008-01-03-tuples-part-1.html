<p>A tuple in computer science can be described as a set of name/value pairs.&nbsp; In some cases it can be described as simply a set of values that are accessible via an index [1].&nbsp; Previously I discussed how to create a <a href="http://blogs.msdn.com/jaredpar/archive/2007/11/29/tuples-in-powershell.aspx">Tuple inside of PowerShell</a>.&nbsp; This series will focus on the use of Tuples in DotNet and how to use PowerShell to generate DotNet code.&nbsp; </p> <p>This series will also distinguish between mutable and immutable tuples.&nbsp; As DotNet is shifting it's focus on parallel programming, immutable types are becoming more important.&nbsp; Therefore this serious will focus on Tuples as immutable types and later examine mutable tuples.</p> <p>In Visual Studio 2005, both C# and VB acquired tuples as a part of the programming language in the form of Anonymous Types.&nbsp; These fit all of the properties of a tuple.&nbsp; The one difference is in VB, anonymous types are mutable by default.&nbsp; This can be changed though by using the <strong>Key</strong> keyword.&nbsp; </p> <p>However anonymous types are lacking one quality which severely lessens their usefulness.&nbsp; <a href="http://blogs.msdn.com/jaredpar/archive/2007/10/01/casting-to-an-anonymous-type.aspx">Their type cannot be described</a>.&nbsp; This prevents them from being used as parameters, fields, generic parameters [2] etc ...&nbsp; Unless you use late binding or terribly awkward casts this is limiting.&nbsp; </p> <p>To get around this, we will be defining a set of generic tuple class supporting 1-N name value pairs.&nbsp; The great downside is because we will be predefining these types the names in the name value pair will be fixed.&nbsp; We will be using A-N for 1-N pairs. </p> <p>This is very limiting in itself because it's reducing the expressiveness of a type.&nbsp; Anonymous types are much more expressive since they have names.&nbsp; Now types will have properties A,B, etc ...&nbsp; </p> <p>For me this still works.&nbsp; In my code, I only end up using tuples when I need to pass data around between tightly coupled classes, or just within the same class.&nbsp;&nbsp; Since the creation and use are so close loosing the full expressiveness of the name is not that limiting.&nbsp; </p> <p>In addition, our tuple implementation will leverage type inference as much as possible such that the following code can be written.</p><a href="http://11011.net/software/vspaste"></a><pre class="code">            <span style="color: rgb(0,0,255)">var</span> tuple = <span style="color: rgb(43,145,175)">Tuple</span>.Create(<span style="color: rgb(163,21,21)">"foo"</span>);
            <span style="color: rgb(43,145,175)">Console</span>.WriteLine(tuple.A);</pre>
<p>Why write a script to generate these classes?&nbsp; Wouldn't it just be easier to just do this by hand???&nbsp; Yes and no.&nbsp; If you are doing a fixed set of short used classes then yes, do it by hand.&nbsp; These scripts evolved out of my use of tuples.&nbsp; Once I would settle on a structure and I would think of a new feature I needed.&nbsp; Typically I have tuples defined up to 5 fields.&nbsp; Retyping out a new feature got tiresome and error prone.&nbsp; With a scripting solution I could add a new feature and tests in just a few minutes.&nbsp; The series is very representative of the way my solution changed over time.&nbsp; Simple at first but I added features as the situation dictated.&nbsp; Having a scripting solution saved me a lot of time.</p>
<p>Next up, generating the basic structure.&nbsp; </p>
<p>[1] In this case, the index just becomes the name and hence a name/value pair. </p></div>
    