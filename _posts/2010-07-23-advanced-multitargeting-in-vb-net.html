<p>Multi-targeting is a feature introduced in Visual Studio 2008 which allows developers to use new versions of Visual Studio to target earlier versions of the .Net platform.&#160; It allowed users to target both the new 3.5 and 3.0 and the previous 2.0 profile with the same IDE.&#160; Visual Studio 2010 <a href="http://msdn.microsoft.com/en-us/magazine/ff714560.aspx">continues this trend</a> by adding support for CLR 4.0 and even allows for further sub-targeting through several <a href="http://channel9.msdn.com/posts/funkyonex/Multi-Targeting-Deep-Dive-with-Visual-Basic-2010/">framework profiles</a>.&#160; </p>  <p>At a compiler level this works by providing binary compatibility with previous versions of the CLR (or producing an error when it’s not possible).&#160; It doesn’t warn developers about using new language constructs on older frameworks so long as they function in the target framework.&#160; </p>  <p>Take the following code sample as an example.&#160; It is taking advantage of <a href="http://blogs.msdn.com/b/vbteam/archive/2009/03/27/implicit-line-continuation-in-vb-10-tyler-whitney.aspx">implicit line continuations</a> which is a feature introduced in VB.Net 10 and not available in Visual Studio 2008.&#160; Since it’s just syntactic sugar it compiles just fine in an application targeting 4.0 or any previous version of the framework.</p>  <pre class="code"><span style="color: blue">Dim </span>query =
    <span style="color: blue">From </span>it <span style="color: blue">In </span>col
    <span style="color: blue">Where </span>it <span style="color: blue">Mod </span>2 = 0
    <span style="color: blue">Select </span>it * 3</pre>

<p>In a limited set of scenarios though developers want to use Visual Studio 2010 to develop code which will also be compiled by a previous version of the compiler.&#160; Hence they want warnings in Visual Studio when new language constructs are used.&#160; </p>

<p>The 10.0 version of vbc.exe introduced a new switch named <a href="http://msdn.microsoft.com/en-us/library/dd547577.aspx">langversion</a> to provide just that.&#160; It allows developers to specify a version of the language to target.&#160; The compiler will then issue an error when a language construct which was introduced in a later version is used.&#160; This switch is not available from the IDE though and must be manually specified in the project file.&#160; To do so edit the .vbproj file and add the following element under the main ItemGroup element.</p>

<pre class="code">  <span style="color: blue">&lt;</span><span style="color: #a31515">PropertyGroup</span><span style="color: blue">&gt;
    &lt;</span><span style="color: #a31515">LangVersion</span><span style="color: blue">&gt;</span>9<span style="color: blue">&lt;/</span><span style="color: #a31515">LangVersion</span><span style="color: blue">&gt;
  &lt;/</span><span style="color: #a31515">PropertyGroup</span><span style="color: blue">&gt;

</span></pre>

<p>Once the project is reloaded errors will start appearing for new language constructs.&#160; Notice how our earlier sample now produces the errors for the usages of the new implicit line continuation construct.&#160; </p>

<p><a href="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-39-97-metablogapi/7612.image_5F00_4.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" class="wlDisabledImage" title="image" border="0" alt="image" src="http://blogs.msdn.com/cfs-file.ashx/__key/CommunityServer-Blogs-Components-WeblogFiles/00-00-00-39-97-metablogapi/3173.image_5F00_thumb_5F00_1.png" width="640" height="547" /></a></p><div style="clear:both;"></div></div>
    