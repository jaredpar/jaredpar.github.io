<P>Believe it or not, you can develop, register and use COM objects with an LUA account [1].&nbsp; COM objects are typically registered at one of one of two places.&nbsp; </P>
<P>&nbsp;&nbsp;&nbsp;HKLM\Software\Classes</P>
<P>&nbsp;&nbsp;&nbsp;HKCU\Software\Classes </P>
<P>Some people think that COM objects are registered under HKEY_CLASSES_ROOT (HKCR).&nbsp; This is partially true.&nbsp; HKCR is not a true registry key in the same way as&nbsp;HKEY_CURRENT_USER (HKCU) and HKEY_LOCAL_MACHINE (HKLM).&nbsp; Instead it is a hybrid key that merges the two keys above giving precedence to the information stored in HKCU.&nbsp; So whenever you open HKCR you are really opening a comibined view of the machine default COM settings and the user COM settings.&nbsp; This combined view will give precedence to <STRONG>user</STRONG> <STRONG>settings</STRONG>.&nbsp; This means that when you create an object with CoCreateInstance() or similar APIs, COM will use an object defined in HKCU, before HKLM.&nbsp; </P>
<P>But wait! ATL generated scripts all write their information to HKCR, how does that work?&nbsp; When you create a new key or&nbsp;value&nbsp;under HKCR, it will default to creating this key under HKLM.&nbsp; Unless the key already exists under HKCU.&nbsp; In that case the information will be stored in its existing location under HKCU.&nbsp; This means that you can develop, register and use COM applications all as an LUA.&nbsp;&nbsp;You can update most RGS files it ATL projects and force them to register under HKCU\Software\Classes&nbsp;instead of HKCR.&nbsp; </P>
<P>The is really only one small <EM>gotcha</EM> to this but it typically only affects services.&nbsp; HKCR will merge HKLM and HKCU.&nbsp; When you are impersonating a user, say in a service, HKCU will still be the settings for the server process and not the impersonated user.&nbsp; This means that users will not be able to override the default behavior when creating COM objects in this manner [2].&nbsp; </P>
<P>Couple of links on the issue</P>
<P><A href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/hkey_classes_root_key.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/hkey_classes_root_key.asp</A></P>
<P><A href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/regopenuserclassesroot.asp">http://msdn.microsoft.com/library/default.asp?url=/library/en-us/sysinfo/base/regopenuserclassesroot.asp</A></P>
<P>&nbsp;</P>
<P>[1] I know it sounds a bit redundant to say LUA account when LUA stands for limited user account.&nbsp; So what I am really saying is limited user account account.&nbsp; But it just sounds weird to say "with an LUA".&nbsp; </P>
<P>[2] Depending on who the user is, that could be a good thing :) </P><div style="clear:both;"></div></div>
    