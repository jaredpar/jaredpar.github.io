<p>This came up on an internal alias.&nbsp; A customer wanted to know how to determine if there were running as an admin in a tool.&nbsp; Below is a sample program that will print out whether or not you are the machine admin or a member of the machine administrators group.&nbsp; </p> <p>&nbsp;</p> <p>This is essentially the same as the code in a previous post of mine but ported to VB.&nbsp; <a title="http://blogs.msdn.com/jaredpar/archive/2005/11/07/489942.aspx" href="http://blogs.msdn.com/jaredpar/archive/2005/11/07/489942.aspx">http://blogs.msdn.com/jaredpar/archive/2005/11/07/489942.aspx</a></p><pre><span style="color: blue">Imports</span> System.Security.Principal
<span style="color: blue">Module</span> Module1

    <span style="color: blue">Function</span> IsRunningAsLocalAdmin() <span style="color: blue">As</span> <span style="color: blue">Boolean</span>
        <span style="color: blue">Dim</span> cur <span style="color: blue">As</span> WindowsIdentity = WindowsIdentity.GetCurrent()
        <span style="color: blue">For</span> <span style="color: blue">Each</span> role <span style="color: blue">As</span> IdentityReference <span style="color: blue">In</span> cur.Groups
            <span style="color: blue">If</span> role.IsValidTargetType(<span style="color: blue">GetType</span>(SecurityIdentifier)) <span style="color: blue">Then</span>
                <span style="color: blue">Dim</span> sid <span style="color: blue">As</span> SecurityIdentifier = <span style="color: blue">DirectCast</span>(role.Translate(<span style="color: blue">GetType</span>(SecurityIdentifier)), SecurityIdentifier)
                <span style="color: blue">If</span> sid.IsWellKnown(WellKnownSidType.AccountAdministratorSid) <span style="color: blue">OrElse</span> sid.IsWellKnown(WellKnownSidType.BuiltinAdministratorsSid) <span style="color: blue">Then</span>
                    <span style="color: blue">Return</span> <span style="color: maroon">True</span>
                <span style="color: blue">End</span> <span style="color: blue">If</span>

            <span style="color: blue">End</span> <span style="color: blue">If</span>
        <span style="color: blue">Next</span>

        <span style="color: blue">Return</span> <span style="color: maroon">False</span>
    <span style="color: blue">End</span> <span style="color: blue">Function</span>

    <span style="color: blue">Sub</span> Main()
        Console.WriteLine(<span style="color: maroon">"Is Admin {0}"</span>, IsRunningAsLocalAdmin())
    <span style="color: blue">End</span> <span style="color: blue">Sub</span>

<span style="color: blue">End</span> <span style="color: blue">Module</span>
</pre></div>
    