<p><a href="http://msdn2.microsoft.com/en-us/library/9eekhta0.aspx">IEnumerable(Of T)</a> is a huge step up in the 2.0 framework from the original <a href="http://msdn2.microsoft.com/en-us/library/9eekhta0.aspx">IEnumerable</a> interface.&nbsp; It provides a typed enumeration which eliminates lots of nasty casts.&nbsp; The best part is that IEnumerable(Of T) is backwards compatible with IEnumerable (it inherits from it).&nbsp; </p> <p>What's frustrating is that IEnumerable is not forwards compatible with IEnumerable(Of Object).&nbsp; This prevents you from using IEnumerable anywhere IEnumerable(Of Object) or an inferred IEnumerable&lt;T&gt; is expected even though they have almost the same interface. The framework couldn't take the same approach and have IEnumerable inherit IEnumerable(Of Object) because it would have broken any implementer on upgrade to the 2.0 framework.&nbsp; </p> <p>The good news is this is easy to shim.&nbsp; Since IEnumerable(Of Object) and IEnumerable have virtually the same, it's easy to create a wrapper class that forwards the calls into the base enumerator.</p> <p>The basic shim involves two classes&nbsp; </p> <ul> <li>EnumerableShim - Implements IEnumerable(Of Object).&nbsp; This class wraps an IEnumerable object only has two methods.&nbsp; </li></ul><pre class="code">    <span style="color: rgb(0,0,255)">Public</span> <span style="color: rgb(0,0,255)">Function</span> GetEnumerator() <span style="color: rgb(0,0,255)">As</span> System.Collections.Generic.IEnumerator(<span style="color: rgb(0,0,255)">Of</span> <span style="color: rgb(0,0,255)">Object</span>) <span style="color: rgb(0,0,255)">Implements</span> System.Collections.Generic.IEnumerable(<span style="color: rgb(0,0,255)">Of</span> <span style="color: rgb(0,0,255)">Object</span>).GetEnumerator
        <span style="color: rgb(0,0,255)">Return</span> <span style="color: rgb(0,0,255)">New</span> EnumeratorShim(m_enumerable.GetEnumerator())
    <span style="color: rgb(0,0,255)">End</span> <span style="color: rgb(0,0,255)">Function

</span>    <span style="color: rgb(0,0,255)">Public</span> <span style="color: rgb(0,0,255)">Function</span> GetEnumerator1() <span style="color: rgb(0,0,255)">As</span> System.Collections.IEnumerator <span style="color: rgb(0,0,255)">Implements</span> System.Collections.IEnumerable.GetEnumerator
        <span style="color: rgb(0,0,255)">Return</span> m_enumerable.GetEnumerator()
    <span style="color: rgb(0,0,255)">End</span> <span style="color: rgb(0,0,255)">Function</span></pre><a href="http://11011.net/software/vspaste"></a>
<ul>
<li>EnumeratorShim - Implements IEnumerator(Of Object).&nbsp; This class wraps the IEnumerator object created above and implements the standard methods by forwarding all calls to the IEnumerator implementation.&nbsp; For example ...</li></ul><pre class="code">        <span style="color: rgb(0,0,255)">Public</span> <span style="color: rgb(0,0,255)">ReadOnly</span> <span style="color: rgb(0,0,255)">Property</span> Current() <span style="color: rgb(0,0,255)">As</span> <span style="color: rgb(0,0,255)">Object</span> <span style="color: rgb(0,0,255)">Implements</span> System.Collections.Generic.IEnumerator(<span style="color: rgb(0,0,255)">Of</span> <span style="color: rgb(0,0,255)">Object</span>).Current
            <span style="color: rgb(0,0,255)">Get
</span>                <span style="color: rgb(0,0,255)">Return</span> m_impl.Current
            <span style="color: rgb(0,0,255)">End</span> <span style="color: rgb(0,0,255)">Get
</span>        <span style="color: rgb(0,0,255)">End</span> <span style="color: rgb(0,0,255)">Property
</span></pre><a href="http://11011.net/software/vspaste"></a>
<p>Now whenever your stuck with and old framework collection that was not updated for generic support, you can use it in generic situations with a single indirection call.&nbsp; </p><pre class="code">        <span style="color: rgb(0,0,255)">Dim</span> list <span style="color: rgb(0,0,255)">As</span> <span style="color: rgb(0,0,255)">New</span> ArrayList
        ...
        SomeMethod(<span style="color: rgb(0,0,255)">New</span> EnumerableShim(list))</pre><a href="http://11011.net/software/vspaste"></a></div>
    