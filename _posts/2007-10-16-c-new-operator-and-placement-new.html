<p>Originally I was going to write this article to detail a particular problem I had recently with placement new in C++.&nbsp; A page or two of writing later I decided it would be best to start with an introduction to the "new" operator itself and the in/outs of overloading/replacing it.&nbsp; The C++ new operator really functions as a 2 step process.</p> <ol> <li>Allocate memory - This is accomplished by calling the in scope "new" operator  <li>Construct object in the allocated memory - Essentially the "this" pointer is pointed to the front of the memory and the constructor is called.&nbsp; </li></ol> <p>You can customize the new operator in your code by defined operator new at a particular scope.&nbsp; </p> <blockquote><pre class="code"><span style="color: rgb(0,0,255)">static</span> <span style="color: rgb(0,0,255)">inline
void</span> * <span style="color: rgb(0,0,255)">_cdecl</span> <span style="color: rgb(0,0,255)">operator</span> <span style="color: rgb(0,0,255)">new</span>(size_t cbSize)
{
... // Return cbSize bytes
}</pre></blockquote>
<p>One item a lot of people don't realize is that "new" is for most purposes a normal C++ function.&nbsp; Like a normal C++ function you can add parameters.&nbsp; Below is a common overload you will see in code.&nbsp; It is typically referred to as placement new.&nbsp; </p>
<blockquote><pre class="code"><span style="color: rgb(0,128,0)">// Placement new
</span><span style="color: rgb(0,0,255)">static</span> <span style="color: rgb(0,0,255)">inline
void</span> * <span style="color: rgb(0,0,255)">_cdecl</span> <span style="color: rgb(0,0,255)">operator</span> <span style="color: rgb(0,0,255)">new</span>(
    size_t cbSize,
    <span style="color: rgb(0,0,255)">void</span> * pv)
{
    <span style="color: rgb(0,0,255)">return</span> pv;
}</pre></blockquote><a href="http://11011.net/software/vspaste"></a>
<p>The next question is how to pass the "pv" parameter?&nbsp; When you want to pass additional parameters to "new" you can do so by opening up an argument paren block immediately after the new.&nbsp; When attempting to bind the operator "new" in scope, the C++ compiler will match the first passed argument to the second argument of the defined new, second to third and so on.&nbsp; </p>
<blockquote><pre class="code">Student *p = <span style="color: rgb(0,0,255)">new</span> (NULL) Student();</pre></blockquote>
<p>This will match the second new operator I defined as NULL is compatible with void*.&nbsp; This particular version of new, placement new, is valuable because it lets you customize how memory is allocated for a particular operation but still us standard C++ constructor syntax.&nbsp; When you redefine operator new you are only taking care of the first step in the C++ new process; memory allocation.&nbsp; The compiler will still perform step #2 on the memory returned from new.&nbsp; This allows the following pattern.</p><pre class="code">    <span style="color: rgb(0,0,255)">void</span> *p = myAllocator.Allocate(<span style="color: rgb(0,0,255)">sizeof</span>(Student));
    Student *p = <span style="color: rgb(0,0,255)">new</span> (p) Student();</pre>
<p>The second line will bind to the placement new operator I defined above and will simply return the value of "p".&nbsp; Student will then be constructed in this memory.&nbsp; </p>
<p>Next time I'll dive into how to make the placement new operator make a custom allocation pattern easier.</p></div>
    