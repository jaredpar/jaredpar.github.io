<p>Script blocks are a powershell construct for storing an expression or group of statements inside an expression.&#160; It’s the equivalent of a C#/F#/VB Lamba expression.&#160; Recently I needed to use a script block but found I had forgotten how to read passed parameters inside the script block.&#160; </p>  <p>Forgetting how to use a feature is typically not a blog worthy post.&#160; However this is at least the fourth time I’ve run into this situation.&#160; Hopefully blogging about it will help me remember.&#160; Or at least give me a quick search result from google. </p>  <p>Normally I go through a few steps when I run into an issue with PowerShell.&#160; </p>  <ol>   <li>Use the built-in '”get-help” command </li>    <li>Search through my library of scripts for previous usages of a pattern </li>    <li>Google for a solution </li>    <li>Experiment within the shell </li> </ol>  <p>Script blocks are one of the problems that seem to hang around until step #4.&#160; </p>  <p>Getting to the documentation is usually a chore.&#160; It is filed under about_script_block.&#160; This is contradicts the built-in type name [scriptblock].&#160; Usually it takes me a few tries to get the documentation up.&#160; The internal documentation is very weak for a script block.&#160; It provides little more than a basic sample.&#160; </p>  <p>My internal library scripts use script blocks pretty heavily but due to the incredibly terse syntax, searching for them is usually fruitless.&#160; After all, they just need a brace pair which is hardly unique within a powershell script.&#160; </p>  <p>This leads to step #3.&#160; I am by no means a google ninja.&#160; In fact I am often shamed by my non-technically oriented wife in getting relevant google results.&#160; Occasionally, I’ve even resorted to asking her to give me search words.&#160; Shameful, yes. </p>  <p>Given that with such common places words as “script”, “block” and “argument”, my chances of getting a good result are pretty slim.&#160; Recently things are brightening up as more people are blogging about powershell.&#160; But it’s still hard to get a good article on the finer points of a script block.&#160; </p>  <p>Now we’re down to experimentation.&#160; Most scripting entry points in PowerShell have access to the built-in $args variable.&#160; This is true for both functions, scripts and filters.</p>  <p>PS&gt; function test() { $args.Count }    <br />PS&gt; test 42     <br />1     <br />PS&gt; test 42 &quot;astring&quot;     <br />2</p>  <p>Perhaps the same is true for a script block.</p>  <p>PS&gt; $a = { $args.Count }    <br />PS&gt; &amp; $a 42     <br />1     <br />PS&gt; &amp; $a 42 &quot;astring&quot;     <br />2     <br />PS&gt;</p>  <p>Success!!!&#160; Maybe I’ll remember next time.&#160; </p></div>
    