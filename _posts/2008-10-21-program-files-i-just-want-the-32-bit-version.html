<p>As part of my <a href="http://blogs.msdn.com/jaredpar/archive/2008/10/16/powershell-and-64-bit-windows-helper-functions.aspx">transition</a> into using 64 bit windows I keep running into a problem with some scripts.&#160; </p>  <p>I have a whole set of Powershell scripts that are dedicated to ensuring certain programs are installed on all of my dev machines.&#160; Or that certain customizations are needed.&#160; A lot of these do file existence checks inside of Program Files.&#160; </p>  <p>Unfortunately in 64 bit windows there are actually two Program Files folders.&#160; One for 64 bit programs and a separate one for 32 bit programs that operate in Wow64 mode.&#160; All code which uses $env:ProgramFiles will point to the 64 bit version.&#160; Most of the programs I custom install (i.e. gvim are actually 32 bit programs).&#160; </p>  <p>Getting the 32 bit Program Files directory is simple enough: ${env:ProgramFiles(x86)}.&#160; Yet it's not portable back to a 32 bit version of windows.&#160; Yet another function to the rescue</p>  <p></p>  <pre>function Get-ProgramFiles32() {
    if (Test-Win64 ) {
        return ${env:ProgramFiles(x86)}
    }
    
    return $env:ProgramFiles
}</pre></div>
    