<p>A feature which seems to be getting more requests recently is support for seeing the return value of a function in the debugger without the need to assign it into a temporary.&nbsp; C++&rsquo;s had this feature for some time but it&rsquo;s been lacking in managed debugging scenarios.&nbsp; <a href="http://blog.sublogic.com/">James Manning</a> recently dedicated a couple of <a href="http://blog.sublogic.com/2010/11/22/visual-studio-debugger-request-return-local-variable/">blog posts</a> to the subject and <a href="http://blog.sublogic.com/2010/12/11/showing-c-method-return-in-debugger-vb-net-can-do-it/">noted</a> that the feature appears to already partially exist for VB.Net</p>
<blockquote>
<p>&ldquo;With VB.NET, the function name shows up as an entry in &lsquo;Locals&rsquo; and the debugger shows us the value it&rsquo;s returning!&nbsp; The C# debugger has no such support, though &ndash; at the same &lsquo;end of method&rsquo; breakpoint, only the parameter passed in is shown.&nbsp;&nbsp; So, clearly the CLR has enough support for the VB.NET debugger to support this feature, which would seem to be a pretty strong argument that the C# debugger certainly <strong>could</strong> implement this feature.&rdquo;</p>
</blockquote>
<p>Indeed C# could implement this feature but it&rsquo;s not a CLR debugging feature that VB.Net is relying on but is rather an issue of VB6 legacy support.&nbsp; The VB6 language didn&rsquo;t have a return statement.&nbsp; Instead values were returned by assigning the value to be returned to the name of the function.&nbsp; For example</p>
<pre class="code">    <span style="color: blue;">Function </span>IsEven(<span style="color: blue;">ByVal </span>i <span style="color: blue;">As Integer</span>)
        <span style="color: blue;">If </span>i <span style="color: blue;">Mod </span>2 = 0 <span style="color: blue;">Then </span>IsEven = <span style="color: blue;">True Else </span>IsEven = <span style="color: blue;">False End If End Function </span></pre>
<p>While VB.Net added a Return statement it still supports this legacy syntax (and it allows the two to be mixed within a single function).&nbsp; The compiler models this by having a local of the same name of the function which is used to store the return value.&nbsp; Returns from the function are rewritten as assignments to this local and then a return of the same local.&nbsp; The debugger understands this hidden local and displays it during the debugging session.&nbsp; This gives VB.Net the appearance of supporting Return value display when in reality it&rsquo;s just a positive side effect of legacy support.&nbsp;</p>
<p>Quick Note:&nbsp; In my experience when <a href="http://stackoverflow.com/questions/591086/vs-get-returned-value-in-c-code">users ask</a> for return value support in the debugger they typically want to see both</p>
<ol>
<li>The return value of the current function they're stepping through</li>
<li>The return value of functions which are stepped over (more heavily requested)</li>
</ol>
<p>VB.Net supports only the first one (via the described method) and C# supports neither.&nbsp;</p>
<p>I do agree it would be really nice if both languages supported #2 (it&rsquo;s an incredibly useful feature in C++).&nbsp; It is possible to do without CLR support but it involves the compiler generating a temporary for every function / property evaluated in a statement and lots of copying values around.&nbsp; This can have a non-trivial impact on program performance even when not debugging and hence I think is unlikely to be done.&nbsp; If #2 does come around it will likely be through the CLR debugger APIs providing access to the return values much in the way it provides access to the <a href="http://msdn.microsoft.com/en-us/library/ms230540(pt-br,VS.90).aspx">current exception</a>.&nbsp;</p>
<p><strong>Update </strong></p>
<p>Starting with Visual Studio 2013 there will be return value debugging support for all managed languages in a uniform manner.&nbsp; It will be exposed in the same way that C++ exposes function return values.&nbsp; More details are available here</p>
<p><a href="http://blogs.msdn.com/b/somasegar/archive/2013/06/26/visual-studio-2013-preview.aspx">http://blogs.msdn.com/b/somasegar/archive/2013/06/26/visual-studio-2013-preview.aspx</a></p>
<p><strong></strong></p><div style="clear:both;"></div></div>
    