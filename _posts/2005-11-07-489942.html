<P>One of the LUA tasks I found very frustrating was detecting whether or not I was running as an Admin in a .BAT script.&nbsp; It's very difficult to do this correctly and the best way I found was to write a separate program that would determine this for me.&nbsp; This has a couple of limitation, the main one being that it adds extra dependencies to your scripts and makes them harder to deploy.&nbsp; </P>
<P>Monad has greatly simplified this task as I can do the detection code uses simple scripts.&nbsp; </P>
<P># Determine if I am running as an Admin<BR>function AmIAdmin()<BR>{<BR>&nbsp;$local:ident = [System.Security.Principal.WindowsIdentity]::GetCurrent()<BR>&nbsp;<BR>&nbsp;foreach ( $local:groupIdent in $ident.Groups )<BR>&nbsp;{<BR>&nbsp;&nbsp;if ( $groupIdent.IsValidTargetType([System.Security.Principal.SecurityIdentifier]) )<BR>&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;$local:groupSid = $groupIdent.Translate([System.Security.Principal.SecurityIdentifier])<BR>&nbsp;&nbsp;&nbsp;if ( $groupSid.IsWellKnown("AccountAdministratorSid") -or $groupSid.IsWellKnown("BuiltinAdministratorsSid"))<BR>&nbsp;&nbsp;&nbsp;{<BR>&nbsp;&nbsp;&nbsp;&nbsp;return $true;<BR>&nbsp;&nbsp;&nbsp;}<BR>&nbsp;&nbsp;}<BR>&nbsp;}<BR>&nbsp;<BR>&nbsp;return $false;<BR>}</P>
<P>I've added this to my profile so now it's really easy to determine if I can complete an action or need to prompt for credentials in my scrips.&nbsp; </P><div style="clear:both;"></div></div>
    